import{j as e,r as s,h as l,u as a}from"./vendor-react-a0IVf7AC.js";import{S as r,a as i}from"./StableInfo-UwJEAXKs.js";import{$ as t,V as n,h as o,b as d,m as c,M as u,R as m}from"./form-components-Dej4WxZX.js";import{u as h}from"./useHorseProfile-DwBCq9lS.js";import{h as x,i as g,C as f,b as p,j,g as v,L as b,B as y}from"./ui-components-Cdkvl4Hk.js";const N=({horse:s,onClick:l})=>{const a=(null==s?void 0:s.id)||(null==s?void 0:s.horseId)||(null==s?void 0:s.HorseId),{horse:r,loading:i}=h(a),t=r||s,n=(null==t?void 0:t.name)||"Unknown Horse",o=x(t),d=(null==t?void 0:t.color)||"",c=(null==t?void 0:t.breed)||"",u=(null==t?void 0:t.age)||"",m=u?g(u):"";return i&&a?e.jsx(f,{className:"cursor-pointer",onClick:l,children:e.jsxs("div",{className:"p-2 flex flex-col",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-24 h-24 mb-2 rounded-full overflow-hidden border-2 border-primary lg:w-full lg:h-30 lg:rounded-md animate-pulse bg-gray-200"})}),e.jsx(p,{className:"text-xs !text-start",children:"Loading..."})]})}):e.jsx(f,{className:"cursor-pointer",onClick:l,children:e.jsxs("div",{className:"p-2 flex flex-col",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-24 h-24 mb-2 rounded-full overflow-hidden border-2 border-primary lg:w-full lg:h-30 lg:rounded-md",children:e.jsx("img",{src:o,alt:j(t),className:"w-full h-full object-cover",loading:"lazy"})})}),e.jsx(p,{className:"text-xs !text-start",children:n}),e.jsxs(v,{className:"text-xs !text-start",children:[d&&e.jsx("p",{children:d}),c&&e.jsx("p",{children:c}),m&&e.jsx("p",{children:m})]})]})})};function w(){const{stableId:h}=l(),{currentStable:x}=o(),g=a(),[f,p]=s.useState(""),j=s.useMemo((()=>h||(null==x?void 0:x.id)),[h,null==x?void 0:x.id]),{horses:v,loading:w,loadingState:S}=(e=>{const[l,a]=s.useState([]),[r,i]=s.useState(!0),[o,d]=s.useState(null),[c,u]=s.useState("fetch"),m=s.useCallback((async()=>{var s;if(!e)return a([]),i(!1),!1;i(!0),u("fetch");try{const s=await t.getHorsesWithOwnersByStable(e);return a(s||[]),d(null),!0}catch(l){return 404===l.status||(null==(s=l.message)?void 0:s.includes("NOT FOUND_404"))?(a([]),d(null)):d(l.message||"Failed to retrieve horses"),!1}finally{i(!1)}}),[e]);return s.useEffect((()=>{m()}),[m]),{horses:l,loading:r,error:o,loadingState:n(r,c),refreshHorses:m}})(j),C=s.useMemo((()=>{if(!v.length)return[];if(!f.trim())return v;const e=f.toLowerCase();return v.filter((s=>{var l;return((null==(l=s.horseName)?void 0:l.toLowerCase())||"").includes(e)}))}),[v,f]),k=s.useCallback((e=>{p(e)}),[]),I=s.useCallback((e=>{g(d(m.HORSE_PROFILE,{horseId:e}))}),[g]),H=s.useMemo((()=>e.jsxs("div",{className:"flex items-center justify-center h-screen",children:[e.jsx(b,{size:"medium",className:"text-gray"}),e.jsx("p",{className:"ml-2",children:null==S?void 0:S.getMessage()})]})),[S]);return w?H:e.jsxs(c.div,{className:"flex flex-col min-h-screen bg-background pb-20 overflow-y-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx("div",{className:"bg-primary-light lg:bg-background",children:e.jsx(u,{})}),e.jsx(r,{stableId:j,searchTerm:f,onSearchChange:k,searchPlaceholder:"Search..."}),e.jsxs("div",{className:"px-5 py-3 md:px-10 lg:px-40 xl:px-60 pt-2 lg:pt-10",children:[e.jsx("div",{className:"mb-5 border-t border-b border-gray py-5 lg:hidden",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"w-full px-10 py-2 border border-primary rounded-lg focus:outline-none focus:ring-1 focus:ring-primary",value:f,onChange:e=>p(e.target.value)}),e.jsx("div",{className:"absolute inset-y-0 left-3 flex items-center",children:e.jsx(i,{className:"w-5 h-5 text-primary",strokeWidth:3})})]})}),e.jsx(c.div,{className:"mb-6 flex justify-center lg:hidden",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.2},children:e.jsx(y,{type:"secondary",className:"w-full max-w-sm",onClick:()=>I(null==x?void 0:x.id),children:"My horse"})}),e.jsx(c.div,{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-5",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.08}}},children:C.map(((s,l)=>e.jsx(c.div,{variants:{hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1}},whileHover:{y:-2,scale:1.02,boxShadow:"0 4px 20px rgba(0,0,0,0.08)"},whileTap:{scale:.98},transition:{duration:.2},children:e.jsx(N,{horse:s,onClick:()=>I(s.id||s.horseId||s.HorseId)})},s.id??`horse-${l}`)))}),0===C.length&&e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-gray",children:"No horses found"})})]})]})}export{w as default};
