import{j as e,u as s,d as a,r as t}from"./vendor-react-B_QZno8V.js";import{B as l,L as r}from"./ui-components-3MKBAZVk.js";import{a as i,R as n,J as o,C as c}from"./form-components-BwsA2IIA.js";import{u as m}from"./useStableOnboarding-DxnGwu5l.js";const d=({onCreateStable:s,onJoinStable:a})=>e.jsxs("div",{className:"space-y-3 flex flex-col items-center",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Welcome to Equilog!"}),e.jsx("p",{className:"text-gray",children:"Let's get started by setting up your stable. You can either create a new stable or join an existing one."})]}),e.jsx(l,{type:"primary",className:"w-9/10 max-w-md",onClick:s,children:"New stable"}),e.jsx(l,{type:"secondary",className:"w-9/10 max-w-md",onClick:a,children:"Search for existing stable"})]}),x=({imageSrc:s="/src/assets/images/FirstLoginImage.webp",imageAlt:a="Horse in paddock",children:t,showImage:l=!0})=>e.jsxs("div",{className:"flex flex-col items-center w-full px-4 sm:px-6 md:px-8",role:"region","aria-labelledby":"onboarding-title",children:[l&&e.jsx("div",{className:"my-2 mx-2",children:e.jsx("div",{className:"relative",children:e.jsx("img",{src:s,alt:a,className:"max-h-[50vh] sm:max-h-[55vh] md:max-h-[50vh] rounded-lg border border-primary object-cover mx-auto"})})}),e.jsx("div",{className:"w-full mt-4 sm:mt-6 mx-2 sm:mx-4",children:t})]}),h=()=>{const l=s(),{verifyToken:h}=i(),{currentStep:u,loading:g,error:b,message:j,loadingState:f,formMethods:p,navigateToStep:v,handleCreateStable:w}=m(),N=a({defaultValues:{stableName:"",streetAddress:"",postCode:"",county:"",typeOfStable:"",stableBoxes:""},mode:"onChange"}),y=a({defaultValues:{stableName:"",streetAddress:"",postCode:"",county:"",typeOfStable:"",stableBoxes:""},mode:"onChange"}),S=async e=>{const s=await w(e);s.success&&s.stable&&(await h(),sessionStorage.removeItem("isFirstLogin"),l(n.SELECT_STABLE))},C=t.useCallback((async e=>{if("request"===e.action&&e.requestSent)try{sessionStorage.removeItem("isFirstLogin"),l(n.SELECT_STABLE,{state:{message:"Your request to join the stable has been sent. Please wait for approval.",type:"success",source:"/stable-onboarding"}})}catch(s){}}),[l]),L=()=>v("create"),k=()=>v("join"),I=()=>v("welcome");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:hidden w-full py-2",role:"main","aria-live":"polite",children:(()=>{if(g)return e.jsx(x,{title:"Setting up your account",showImage:!1,children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(r,{size:"medium"})}),e.jsx("p",{className:"text-center text-gray",children:f.getMessage()||"Setting up your new account..."})]})});switch(u){case"welcome":return e.jsx(x,{title:"EQUILOG",showImage:!0,children:e.jsx(d,{onCreateStable:L,onJoinStable:k})});case"create":return e.jsx(x,{title:"Create new Stable",showImage:!1,children:e.jsx(c,{formMethods:p,onSubmit:S,onCancel:I,isLoading:g,loadingState:f,error:b,message:j})});case"join":return e.jsx(x,{title:"Join Stable",showImage:!1,children:e.jsx(o,{formMethods:p,onSubmit:C,onCancel:I,isLoading:g,loadingState:f,error:b,message:j})});default:return e.jsx("div",{children:"Unknown step"})}})()}),e.jsxs("div",{className:"hidden lg:flex h-screen overflow-hidden",children:[e.jsx("div",{className:"w-1/2 bg-background p-8 overflow-y-auto flex flex-col items-center",children:e.jsxs("div",{className:"max-w-md w-full mt-16",children:[e.jsx("h2",{className:"text-3xl mb-10 text-center",children:"Join a stable"}),e.jsx("div",{className:"mb-10",children:e.jsx(o,{formMethods:N,onSubmit:C,onCancel:null,isLoading:g,loadingState:f,error:b,message:j,hideLabel:!0,inputClassName:"!bg-white",desktopView:!0})}),e.jsxs("div",{className:"flex items-center my-8",children:[e.jsx("div",{className:"flex-1 border-t border-gray"}),e.jsx("span",{className:"px-4 text-gray",children:"Or"}),e.jsx("div",{className:"flex-1 border-t border-gray"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4",children:[e.jsx("span",{className:"text-sm text-gray",children:"Go back to"}),e.jsx("button",{type:"button",className:"text-sm font-semibold text-primary hover:underline focus:outline-none",onClick:()=>l(n.LOGIN),children:"Sign in"})]})]})}),e.jsx("div",{className:"w-1/2 bg-white p-1 overflow-y-auto flex flex-col items-center",children:e.jsxs("div",{className:"max-w-md w-full mt-16",children:[e.jsx("h2",{className:"text-3xl mb-8 text-center",children:"Create a stable"}),e.jsx("div",{className:"max-h-8/12",children:e.jsx(c,{formMethods:y,onSubmit:S,onCancel:null,isLoading:g,loadingState:f,error:b,message:j,desktopView:!0,hideLabel:!0,inputClassName:""})})]})})]})]})},u=()=>e.jsx("div",{className:"h-full w-full",children:e.jsx(h,{})});export{u as default};
