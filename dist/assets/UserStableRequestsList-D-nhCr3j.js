import{j as e,r as t}from"./vendor-react-a0IVf7AC.js";import{y as s,H as a,a as r,Q as n,V as i}from"./form-components-Dej4WxZX.js";import{u as l}from"./useStableManagement-MqHR1GDD.js";import{B as o,c,L as d}from"./ui-components-Cdkvl4Hk.js";const m=({className:t,strokeWidth:s=2,color:a="currentColor"})=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:e.jsx("path",{d:"M4 12.6111L8.92308 17.5L20 6.5",stroke:a,strokeWidth:s,strokeLinecap:"round",strokeLinejoin:"round"})}),u=({stableId:r})=>{const[n,i]=t.useState(!1),[d,u]=t.useState(!1),[x,h]=t.useState(null),{receivedRequests:p,loading:j,approveRequest:g,rejectRequest:f}=l(r);return j?e.jsx("div",{className:"text-center py-4",children:"Loading requests..."}):e.jsxs("section",{className:"bg-white rounded-lg shadow-sm md:shadow-md p-4 md:p-6",children:[e.jsx("header",{children:e.jsx("h2",{className:"font-bold mb-4 text-lg md:text-xl",children:"Stable join requests"})}),e.jsxs("div",{className:"space-y-1 max-h-64 md:max-h-80 lg:max-h-96 overflow-y-auto",children:[p.map(((t,a)=>e.jsxs("article",{className:"flex flex-col md:flex-row md:items-center justify-between py-3 md:py-4 border-b border-light",children:[e.jsxs("div",{className:"mb-2 md:mb-0",children:[e.jsx("h3",{className:"font-medium text-base md:text-lg",children:`${t.firstName} ${t.lastName}`}),e.jsx("p",{className:"text-sm text-gray",children:t.email}),e.jsx("p",{className:"text-xs text-gray",children:t.inviteDate?new Date(t.inviteDate).toLocaleDateString():"Date not available"})]}),e.jsxs("div",{className:"flex justify-end md:justify-center space-x-2",children:[e.jsx(o,{type:"icon",onClick:()=>(e=>{h(e),u(!0)})(t),"aria-label":"Accept request",className:"text-primary",children:e.jsx(m,{strokeWidth:4})}),e.jsx(o,{type:"icon",onClick:()=>(e=>{h(e),i(!0)})(t),"aria-label":"Reject request",className:"text-error-500",children:e.jsx(s,{strokeWidth:4})})]})]},`request-${t.id}-${a}`))),0===p.length&&e.jsx("p",{className:"py-8 text-center text-gray",children:"No pending requests"})]}),e.jsx(c,{isOpen:n,onClose:()=>i(!1),onConfirm:()=>{x&&(f(x.id),i(!1),h(null))},loading:j,title:"Do you want to reject this request?",confirmButtonText:"Yes",confirmButtonType:"danger",cancelButtonText:"No",icon:e.jsx(a,{size:70,backgroundColor:"bg-error-500",iconColor:"text-white"})}),e.jsx(c,{isOpen:d,onClose:()=>u(!1),onConfirm:()=>{x&&(g(x.id),u(!1),h(null))},loading:j,title:`Do you want to accept ${(null==x?void 0:x.firstName)||"this member"}?`,confirmButtonText:"Yes",confirmButtonType:"primary",cancelButtonText:"No",icon:e.jsx(m,{size:70,className:"text-white",backgroundColor:"bg-primary",strokeWidth:4})})]})},x=()=>{const[l,m]=t.useState(!1),[u,x]=t.useState(null),{sentRequests:h,loading:p,error:j,loadingState:g,cancelRequest:f}=(()=>{const[e,s]=t.useState([]),[a,l]=t.useState([]),[o,c]=t.useState(!0),[d,m]=t.useState(null),[u,x]=t.useState("fetch"),{user:h}=r(),p=i(o,u),j=t.useCallback((async()=>{if(null==h?void 0:h.id){c(!0),x("fetch");try{const e=await n.getUserStableRequests(h.id);s(Array.isArray(e)?e:[]),l([]),m(null)}catch(e){m(e.message||"Failed to load your stable requests"),s([]),l([])}finally{c(!1)}}}),[null==h?void 0:h.id]);return t.useEffect((()=>{j()}),[j]),{sentRequests:e,receivedInvites:a,loading:o,error:d,loadingState:p,cancelRequest:async e=>{if(!(null==h?void 0:h.id)||!e)return!1;c(!0),x("update");try{return await n.cancelStableJoinRequest({userId:h.id,stableId:e}),await j(),!0}catch(t){return m(t.message||"Failed to cancel request"),c(!1),!1}},acceptInvite:async e=>{if(!(null==h?void 0:h.id)||!e)return!1;c(!0),x("update");try{return await n.acceptStableInvite({userId:h.id,stableId:e}),await j(),!0}catch(t){return m(t.message||"Failed to accept invite"),c(!1),!1}},rejectInvite:async e=>{if(!(null==h?void 0:h.id)||!e)return!1;c(!0),x("update");try{return await n.refuseStableInvite({userId:h.id,stableId:e}),await j(),!0}catch(t){return m(t.message||"Failed to reject invite"),c(!1),!1}},refreshData:j}})();return p?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx(d,{size:"medium",className:"text-gray"}),e.jsx("p",{className:"ml-2",children:g.getMessage()})]}):j?e.jsx("div",{className:"bg-red-50 border-l-4 border-error-400 p-4 text-error-600",children:j}):e.jsxs("section",{className:"bg-white rounded-lg shadow-sm md:shadow-md p-4 md:p-6",children:[e.jsx("header",{children:e.jsx("h2",{className:"font-bold mb-4 text-lg md:text-xl",children:"Your pending stable applications"})}),e.jsxs("div",{className:"space-y-1 max-h-64 md:max-h-80 lg:max-h-96 overflow-y-auto",children:[h.map(((t,a)=>e.jsxs("article",{className:"flex flex-col md:flex-row md:items-center justify-between py-3 md:py-4 border-b border-light",children:[e.jsxs("div",{className:"mb-2 md:mb-0",children:[e.jsx("h3",{className:"font-medium text-base md:text-lg",children:t.name}),e.jsxs("p",{className:"text-sm text-gray",children:[t.type,", ",t.county]}),e.jsx("p",{className:"text-xs text-gray",children:t.requestDate?new Date(t.requestDate).toLocaleDateString():"Date not available"})]}),e.jsx("div",{className:"flex justify-end md:justify-center",children:e.jsx(o,{type:"icon",onClick:()=>(x(t),void m(!0)),"aria-label":"Cancel request",className:"text-error-500",children:e.jsx(s,{strokeWidth:4})})})]},`sent-${t.id}-${a}`))),0===h.length&&e.jsx("p",{className:"py-8 text-center text-gray",children:"No pending requests"})]}),e.jsx(c,{isOpen:l,onClose:()=>m(!1),onConfirm:()=>{u&&(f(u.id),m(!1),x(null))},loading:p,title:"Cancel request?",confirmButtonText:"Yes",confirmButtonType:"danger",cancelButtonText:"No",icon:e.jsx(a,{size:70,backgroundColor:"bg-error-500",iconColor:"text-white"}),children:e.jsxs("p",{children:["Your request to join"," ",e.jsx("span",{className:"font-medium",children:(null==u?void 0:u.name)||"this stable"})," ","will be canceled."]})})]})};export{m as C,u as S,x as U};
