import{j as e,B as w,o as v,k as N,u as R,D as g,b as q,L as k}from"./index-B8Zmxeox.js";import{r as o}from"./vendor-router-BURTDQSf.js";import{H as C}from"./HandRaisedIcon-C5lZsX6N.js";import{u as D}from"./useStableManagement-BE2FsDvI.js";const S=({className:h,strokeWidth:i=2,color:l="currentColor"})=>e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:h,children:e.jsx("path",{d:"M4 12.6111L8.92308 17.5L20 6.5",stroke:l,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round"})}),A=({stableId:h})=>{const[i,l]=o.useState(!1),[f,m]=o.useState(!1),[t,u]=o.useState(null),{receivedRequests:c,loading:p,approveRequest:x,rejectRequest:r}=D(h),n=a=>{u(a),l(!0)},d=()=>{t&&(r(t.id),l(!1),u(null))},b=a=>{u(a),m(!0)},y=()=>{t&&(x(t.id),m(!1),u(null))};return p?e.jsx("div",{className:"text-center py-4",children:"Loading requests..."}):e.jsxs("section",{className:"bg-white rounded-lg shadow-sm md:shadow-md p-4 md:p-6",children:[e.jsx("header",{children:e.jsx("h2",{className:"font-bold mb-4 text-lg md:text-xl",children:"Stable join requests"})}),e.jsxs("div",{className:"space-y-1 max-h-64 md:max-h-80 lg:max-h-96 overflow-y-auto",children:[c.map((a,s)=>e.jsxs("article",{className:"flex flex-col md:flex-row md:items-center justify-between py-3 md:py-4 border-b border-light",children:[e.jsxs("div",{className:"mb-2 md:mb-0",children:[e.jsx("h3",{className:"font-medium text-base md:text-lg",children:`${a.firstName} ${a.lastName}`}),e.jsx("p",{className:"text-sm text-gray",children:a.email}),e.jsx("p",{className:"text-xs text-gray",children:a.inviteDate?new Date(a.inviteDate).toLocaleDateString():"Date not available"})]}),e.jsxs("div",{className:"flex justify-end md:justify-center space-x-2",children:[e.jsx(w,{variant:"icon",onClick:()=>b(a),"aria-label":"Accept request",className:"text-primary",children:e.jsx(S,{strokeWidth:4})}),e.jsx(w,{variant:"icon",onClick:()=>n(a),"aria-label":"Reject request",className:"text-error-500",children:e.jsx(v,{strokeWidth:4})})]})]},`request-${a.id}-${s}`)),c.length===0&&e.jsx("p",{className:"py-8 text-center text-gray",children:"No pending requests"})]}),e.jsx(N,{isOpen:i,onClose:()=>l(!1),onConfirm:d,loading:p,title:"Do you want to reject this request?",confirmButtonText:"Yes",confirmButtonType:"danger",cancelButtonText:"No",icon:e.jsx(C,{size:70,backgroundColor:"bg-error-500",iconColor:"text-white"})}),e.jsx(N,{isOpen:f,onClose:()=>m(!1),onConfirm:y,loading:p,title:`Do you want to accept ${t?.firstName||"this member"}?`,confirmButtonText:"Yes",confirmButtonType:"primary",cancelButtonText:"No",icon:e.jsx(S,{size:70,className:"text-white",backgroundColor:"bg-primary",strokeWidth:4})})]})},I=()=>{const[h,i]=o.useState([]),[l,f]=o.useState([]),[m,t]=o.useState(!0),[u,c]=o.useState(null),[p,x]=o.useState("fetch"),{user:r}=R(),n=q(m,p),d=o.useCallback(async()=>{if(r?.id){t(!0),x("fetch");try{const s=await g.getUserStableRequests(r.id);i(Array.isArray(s)?s:[]),f([]),c(null)}catch(s){c(s.message||"Failed to load your stable requests"),i([]),f([])}finally{t(!1)}}},[r?.id]),b=async s=>{if(!r?.id||!s)return!1;t(!0),x("update");try{return await g.cancelStableJoinRequest({userId:r.id,stableId:s}),await d(),!0}catch(j){return c(j.message||"Failed to cancel request"),t(!1),!1}},y=async s=>{if(!r?.id||!s)return!1;t(!0),x("update");try{return await g.acceptStableInvite({userId:r.id,stableId:s}),await d(),!0}catch(j){return c(j.message||"Failed to accept invite"),t(!1),!1}},a=async s=>{if(!r?.id||!s)return!1;t(!0),x("update");try{return await g.refuseStableInvite({userId:r.id,stableId:s}),await d(),!0}catch(j){return c(j.message||"Failed to reject invite"),t(!1),!1}};return o.useEffect(()=>{d()},[d]),{sentRequests:h,receivedInvites:l,loading:m,error:u,loadingState:n,cancelRequest:b,acceptInvite:y,rejectInvite:a,refreshData:d}},$=()=>{const[h,i]=o.useState(!1),[l,f]=o.useState(null),{sentRequests:m,loading:t,error:u,loadingState:c,cancelRequest:p}=I(),x=n=>{f(n),i(!0)},r=()=>{l&&(p(l.id),i(!1),f(null))};return t?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx(k,{size:"medium",className:"text-gray"}),e.jsx("p",{className:"ml-2",children:c.getMessage()})]}):u?e.jsx("div",{className:"bg-red-50 border-l-4 border-error-400 p-4 text-error-600",children:u}):e.jsxs("section",{className:"bg-white rounded-lg shadow-sm md:shadow-md p-4 md:p-6",children:[e.jsx("header",{children:e.jsx("h2",{className:"font-bold mb-4 text-lg md:text-xl",children:"Your pending stable applications"})}),e.jsxs("div",{className:"space-y-1 max-h-64 md:max-h-80 lg:max-h-96 overflow-y-auto",children:[m.map((n,d)=>e.jsxs("article",{className:"flex flex-col md:flex-row md:items-center justify-between py-3 md:py-4 border-b border-light",children:[e.jsxs("div",{className:"mb-2 md:mb-0",children:[e.jsx("h3",{className:"font-medium text-base md:text-lg",children:n.name}),e.jsxs("p",{className:"text-sm text-gray",children:[n.type,", ",n.county]}),e.jsx("p",{className:"text-xs text-gray",children:n.requestDate?new Date(n.requestDate).toLocaleDateString():"Date not available"})]}),e.jsx("div",{className:"flex justify-end md:justify-center",children:e.jsx(w,{variant:"icon",onClick:()=>x(n),"aria-label":"Cancel request",className:"text-error-500",children:e.jsx(v,{strokeWidth:4})})})]},`sent-${n.id}-${d}`)),m.length===0&&e.jsx("p",{className:"py-8 text-center text-gray",children:"No pending requests"})]}),e.jsx(N,{isOpen:h,onClose:()=>i(!1),onConfirm:r,loading:t,title:"Cancel request?",confirmButtonText:"Yes",confirmButtonType:"danger",cancelButtonText:"No",icon:e.jsx(C,{size:70,backgroundColor:"bg-error-500",iconColor:"text-white"}),children:e.jsxs("p",{children:["Your request to join"," ",e.jsx("span",{className:"font-medium",children:l?.name||"this stable"})," ","will be canceled."]})})]})};export{S as C,A as S,$ as U};
