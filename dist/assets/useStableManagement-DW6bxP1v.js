import{r as e}from"./vendor-react-B_QZno8V.js";import{h as t,k as a,Q as r,V as s}from"./form-components-BwsA2IIA.js";const i=i=>{const[c,l]=e.useState([]),[u,n]=e.useState([]),[o,d]=e.useState(!0),[m,b]=e.useState(null),[p,y]=e.useState("fetch"),[S,f]=e.useState([]),{stableRefreshKey:I}=t(),v=s(o,p),w=e.useCallback((async()=>{if(i){d(!0),y("fetch");try{const e=await a.getUsersByStableId(i),t=Array.isArray(e)?e.map((e=>({id:e.userStableId,userId:e.userId,firstName:e.firstName,lastName:e.lastName,role:e.role,profilePicture:e.profilePicture}))):[];l(t);const s=await r.getStableRequests(i);n(s.received||[]);const c=await r.getStableInvites(i);f(Array.isArray(c)?c:[]),b(null)}catch(e){b(e.message||"Failed to load stable data")}finally{d(!1)}}}),[i]);return e.useEffect((()=>{w()}),[w,I]),{members:c,receivedRequests:u,sentInvites:S,loading:o,error:m,loadingState:v,approveRequest:async e=>{d(!0),y("update");try{const t={userId:e,stableId:i};return await r.acceptStableJoinRequest(t),await w(),!0}catch(t){return b(t.message||"Failed to approve request"),d(!1),!1}},updateMemberRole:async(e,t)=>{d(!0),y("update");try{return await a.updateUserStableRole(e,t),await w(),!0}catch(r){return b(r.message||"Failed to update member role"),d(!1),!1}},rejectRequest:async e=>{d(!0),y("update");try{return await r.rejectStableJoinRequest({userId:e,stableId:i}),await w(),!0}catch(t){return b(t.message||"Failed to reject request"),d(!1),!1}},cancelInvitation:async e=>{d(!0),y("update");try{return await r.cancelStableInvite({userId:e,stableId:i}),await w(),!0}catch(t){return b(t.message||"Failed to cancel invitation"),d(!1),!1}},removeUserFromStable:async e=>{d(!0),y("delete");try{return await a.removeUserFromStable(e),await w(),!0}catch(t){return b(t.message||"Failed to remove member"),d(!1),!1}},refreshData:w}};export{i as u};
