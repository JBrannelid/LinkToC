import{r as e,j as s}from"./vendor-react-a0IVf7AC.js";import{U as r,m as l,P as a,h as i,M as t}from"./form-components-Dej4WxZX.js";import{P as d}from"./PermissionGate-bbGAlBBf.js";import{C as n,S as m,U as c}from"./UserStableRequestsList-D-nhCr3j.js";import{u as o}from"./useStableManagement-MqHR1GDD.js";import{B as x}from"./ui-components-Cdkvl4Hk.js";const h=[{id:r.USER,label:"Member"},{id:r.ADMIN,label:"Admin"},{id:r.MANAGER,label:"Owner"}],b=({stableId:i})=>{const[t,m]=e.useState(!1),[c,b]=e.useState(null),[u,j]=e.useState(null),{members:p,loading:N,updateMemberRole:g,removeUserFromStable:f}=o(i),y=e=>{b(e),j(e.role),m(!0)},v=()=>{m(!1),b(null)},w=e=>{const s=h.find((s=>s.id===e));return s?s.label:"Member"},A={[r.MANAGER]:p.filter((e=>e.role===r.MANAGER)),[r.ADMIN]:p.filter((e=>e.role===r.ADMIN)),[r.USER]:p.filter((e=>e.role===r.USER))};return N?s.jsx("div",{className:"text-center py-4",children:"Loading members..."}):s.jsxs("section",{className:"bg-white rounded-lg shadow-sm md:shadow-md p-4 md:p-6",children:[s.jsxs("header",{children:[s.jsx("h2",{className:"font-bold mb-1 text-lg md:text-xl",children:"Members"}),s.jsx(d,{requiredRoles:[r.MANAGER],fallback:s.jsx("p",{className:"text-sm mb-4 pt-1 text-gray",children:"Only stable owners can edit a member"}),children:s.jsx("p",{className:"text-sm mb-4 pt-1 text-gray",children:"You can manage all members as the stable owner"})})]}),s.jsxs(l.div,{className:"max-h-64 md:max-h-80 lg:max-h-96 overflow-y-auto pr-1 space-y-1",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.1}}},children:[" ",A[r.MANAGER].length>0&&s.jsxs("section",{className:"mb-3",children:[s.jsx("h3",{className:"text-xs text-gray border-b pb-1 mb-2",children:"Stable Owners"}),A[r.MANAGER].map((e=>s.jsx(d,{requiredRoles:[r.MANAGER],children:s.jsx(l.article,{className:"flex items-center justify-between py-2 px-3 bg-light/30 rounded-lg mb-2 cursor-pointer",variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},whileHover:{backgroundColor:"rgba(2, 122, 72, 0.05)",transition:{duration:.5}},onClick:()=>y(e),children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden mr-3",children:s.jsx(a,{user:e,className:"w-full h-full",size:"small"})}),s.jsx("p",{className:"text-sm",children:`${e.firstName} ${e.lastName}`})]})},`member-${e.id}`)},`member-${e.id}`)))]}),A[r.ADMIN].length>0&&s.jsxs("section",{className:"mb-3",children:[s.jsx(d,{requiredRoles:[r.MANAGER],children:s.jsx("h3",{className:"text-xs text-gray border-b pb-1 mb-2",children:"Administrators"})}),A[r.ADMIN].map((e=>s.jsx(d,{requiredRoles:[r.MANAGER],children:s.jsxs(l.article,{className:"flex items-center justify-between py-2 px-3 bg-light/30 rounded-lg mb-2 cursor-pointer",variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},whileHover:{backgroundColor:"rgba(2, 122, 72, 0.05)",transition:{duration:.5}},onClick:()=>y(e),children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden mr-3",children:s.jsx(a,{user:e,className:"w-full h-full",size:"small"})}),s.jsx("p",{className:"text-sm",children:`${e.firstName} ${e.lastName}`})]}),s.jsx("span",{className:"px-2 py-1 bg-primary-light text-primary rounded-full text-sm",children:w(e.role)})]},`member-${e.id}`)},`member-${e.id}`)))]}),A[r.USER].length>0&&s.jsxs("section",{className:"mb-3",children:[s.jsx(d,{requiredRoles:[r.MANAGER],children:s.jsx("h3",{className:"text-xs text-gray border-b pb-1 mb-2",children:"Members"})}),A[r.USER].map((e=>s.jsxs(d,{requiredRoles:[r.MANAGER],children:[s.jsxs(l.article,{className:"flex items-center justify-between py-2 px-3 bg-light/30 rounded-lg mb-2 cursor-pointer",variants:{hidden:{opacity:0,y:10},visible:{opacity:1,y:0}},whileHover:{backgroundColor:"rgba(2, 122, 72, 0.05)",transition:{duration:.5}},onClick:()=>y(e),children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden mr-3",children:s.jsx(a,{user:e,className:"w-full h-full",size:"small"})}),s.jsx("p",{className:"text-sm",children:`${e.firstName} ${e.lastName}`})]}),s.jsx("span",{className:"px-2 py-1 bg-primary-light text-primary rounded-full text-sm",children:w(e.role)})]},`member-${e.id}`)," "]},`member-${e.id}`)))]})]}),t&&c&&s.jsx("div",{className:"fixed inset-0 bg-gray/30 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg w-11/12 max-w-md p-4",children:[s.jsxs("h3",{className:"mb-2 text-lg",children:["Manage member"," ",s.jsxs("span",{className:"text-sm font-semibold text-primary",children:[c.firstName," ",c.lastName]})]}),s.jsx("div",{className:"border-t py-3 mb-2",children:s.jsxs("fieldset",{className:"grid grid-cols-4 gap-1 mb-3",children:[h.map((e=>s.jsxs("div",{className:"text-center",children:[s.jsx("label",{className:"text-sm mb-2 block",children:e.label}),s.jsx("div",{className:"w-5 h-5 mx-auto rounded-full border flex items-center justify-center cursor-pointer "+(u===e.id?"border-primary bg-primary":"border-gray"),onClick:()=>j(e.id),role:"radio","aria-checked":u===e.id,tabIndex:0,children:u===e.id&&s.jsx(n,{className:"text-white w-4 h-4"})})]},e.id))),s.jsxs("div",{className:"text-center",children:[s.jsx("label",{className:"text-sm mb-2 text-error-500 block",children:"Remove"}),s.jsx("div",{className:"w-5 h-5 mx-auto rounded-full border flex items-center justify-center cursor-pointer "+("remove"===u?"border-error-500 bg-error-500":"border-gray"),onClick:()=>j("remove"),role:"radio","aria-checked":"remove"===u,tabIndex:0,children:"remove"===u&&s.jsx(n,{className:"text-white w-4 h-4"})})]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(x,{type:"secondary",onClick:v,children:"Cancel"}),s.jsx(x,{type:"primary",onClick:()=>{"remove"===u?c&&(f(c.id),v()):null!==u&&u!==c.role&&(async()=>{c&&null!==u&&u!==c.role&&(await g(c.id,u),v())})()},disabled:null===u||"remove"!==u&&u===c.role,children:"Save"})]})]})})]})},u=()=>{const{currentStable:e}=i();return s.jsx(d,{requiredRoles:[r.ADMIN,r.MANAGER],children:s.jsxs("div",{className:"flex flex-col min-h-screen bg-background pb-20 overflow-y-hidden",children:[s.jsx("div",{className:"bg-primary-light lg:bg-background",children:s.jsx(t,{title:"Manage Stables",showCloseBtn:!1,onCloseClick:()=>window.history.back()})}),s.jsx("div",{className:"flex-1 px-4 py-6 md:px-8 lg:px-16 xl:px-80 ",children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[s.jsx(b,{stableId:null==e?void 0:e.id}),s.jsx(m,{stableId:null==e?void 0:e.id}),s.jsx(c,{}),s.jsx("div",{className:"hidden lg:flex justify-start",children:s.jsx(x,{type:"secondary",onClick:()=>{window.history.back()},className:"w-auto",children:"Go back"})})]})})]})})};export{u as default};
