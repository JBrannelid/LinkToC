import{j as e,L as H,m as y,P as E,l as O,R,u as C,B as f}from"./index-BEvGyptE.js";import{u as B,r as j,e as $}from"./vendor-router-BURTDQSf.js";import{g as M,a as T,f as W,u as A}from"./useHorseProfile-Cv_mkgpd.js";import{E as k}from"./EditInformationModal-BZQa1AyU.js";import{P as b}from"./PenIcon-CR8A0-VE.js";import"./vendor-react-DavUf6mE.js";import"./vendor-forms-DlkW-UdB.js";import"./horseService-n4olh4yN.js";import"./FormMessage-DkOtjBWz.js";import"./JoinStableForm-DEBWaGz6.js";import"./HandRaisedIcon-BPyHQwh7.js";import"./LocationPinIcon-C-xH8vE4.js";const L=({horseProfile:r})=>{const l=B(),n=r?.userHorseRoles||[],o=!r,i=t=>{t&&l(O(R.USER_PROFILE,{userId:t}))};return o?e.jsxs("div",{className:"flex justify-center items-center p-4",children:[e.jsx(H,{size:"medium",className:"text-gray"}),e.jsx("span",{className:"ml-2",children:"Loading horse's owners..."})]}):!n||n.length===0?e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsx("p",{className:"text-center text-gray py-4",children:"No owners registered for this horse"})}):e.jsx(e.Fragment,{children:e.jsxs(y.div,{className:"grid grid-cols-1 gap-4 px-10 sm:grid-cols-2 sm:gap-15 lg:grid-cols-3 lg:gap-6",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.1}}},children:[" ",n.map((t,s)=>{if(!t)return null;const a=t.user||{},c=`${a.firstName||""} ${a.lastName||""}`.trim()||"Unnamed User",d=M(t.userRole);return e.jsxs(y.div,{className:"border border-primary rounded-lg overflow-hidden cursor-pointer mx-auto max-w-xs bg-gradient-to-b from-primary-light to-white",onClick:()=>i(a.id),variants:{hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},whileHover:{y:-4,scale:1.02,boxShadow:"0 8px 25px rgba(0,0,0,0.12)"},whileTap:{scale:.98},transition:{duration:.2},children:[e.jsx("div",{className:"flex justify-center items-center overflow-hidden ",children:e.jsx(E,{user:a,className:"scale-70 w-35 h-35 sm:w-45 sm:h-45 md:w-40 md:h-40 lg:w-48 lg:h-48 object-cover border-2 border-primary rounded-full bg-background",size:"rounded",alt:`User ${c}`})}),e.jsxs("div",{className:"p-3 text-center",children:[e.jsx("h3",{className:"font-bold",children:c}),e.jsxs("p",{className:" text-sm",children:["Role: ",d||"Connected",e.jsx("br",{}),a.phoneNumber&&`Phone: ${a.phoneNumber}`]})]})]},`user-${a.id||s}`)})]})})},D=({horse:r,horseProfile:l,activeTab:n,forceRefresh:o})=>{const{user:i}=C(),[t,s]=j.useState({isOpen:!1,field:"",label:"",value:"",multiline:!1}),a=l?.horse||r,c=a?.id,d=l?.userHorseRoles?.some(g=>String(g.user?.id)===String(i?.id)),m=(g,N,h,p=!1)=>{s({isOpen:!0,field:g,label:N,value:h,multiline:p})},u=()=>{s({isOpen:!1,field:"",label:"",value:"",multiline:!1})},x=()=>{switch(n){case"info":return e.jsx(w,{horse:a,horseProfile:l,openEditModal:m,hasHorseRole:d});case"owners":return e.jsx(L,{horseId:c,horseProfile:l});default:return e.jsx(w,{horse:a,horseProfile:l,openEditModal:m,hasHorseRole:d})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block lg:px-40 xl:px-60 py-4",children:x()}),e.jsx("div",{className:"py-2 lg:hidden",children:x()}),e.jsx(k,{isOpen:t.isOpen,onClose:u,fieldName:t.field,fieldLabel:t.label,initialValue:t.value,userId:c,multiline:t.multiline,userData:a,refreshUserData:o,isHorse:!0,isCurrentUser:d})]})},w=({horse:r,openEditModal:l,hasHorseRole:n})=>{const o=r?.coreInformation||"No important information added yet",i=r?.bio||r?.description||r?.about||"Time to write your legend! ✍️";return e.jsxs("div",{className:"space-y-4 px-10",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("div",{children:e.jsx("h3",{className:"font-normal mr-2 text-start text-xl",children:"Important "})}),e.jsx("div",{className:"bg-primary-light p-4 rounded-lg shadow-lg w-full cursor-pointer hover:border hover:border-primary",onClick:n?()=>l("coreInformation","Important info",o):void 0,children:e.jsx("p",{className:"font-semibold",children:o})})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-lg cursor-pointer hover:border hover:border-primary",onClick:n?()=>l("description","About Horse",i,!0):void 0,children:e.jsx("p",{className:"whitespace-pre-line",children:i})})]})},z=({horse:r,horseProfile:l,forceRefresh:n})=>{const{user:o}=C(),[i,t]=j.useState({isOpen:!1,field:"",label:"",value:"",multiline:!1}),s=l?.horse||r,a=s.name||"Unnamed Horse",c=T(s),d=s.color||"Unknown color",m=W(s.age),u=s.breed||"Unknown breed",x=s.currentBox||s.stablePlace||"",g=s.weight||"",N=s.height||"",h=l?.userHorseRoles?.some(v=>String(v.user?.id)===String(o?.id)),p=(v,I,P,S=!1)=>{t({isOpen:!0,field:v,label:I,value:P,multiline:S})},U=()=>{t({isOpen:!1,field:"",label:"",value:"",multiline:!1})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden lg:block lg:px-40 xl:px-60 pt-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex flex-col relative group",children:[e.jsx("h1",{className:"text-3xl font-heading font-semibold",children:a}),e.jsx("p",{className:"text-sm text-gray",children:m}),e.jsxs("p",{className:"text-sm text-gray",children:["Breed - ",u]}),e.jsxs("p",{className:"text-sm text-gray",children:["Color - ",d]})]}),e.jsxs("div",{className:"flex flex-row gap-2 mr-5 mt-10",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs(f,{type:"secondary",className:"rounded-lg !border-primary flex flex-col max-h-20 min-h-15 min-w-25","aria-label":"Stable Place",children:[e.jsx("span",{className:"text-primary mb-1",children:"Box"}),e.jsx("span",{className:"text-xs",children:x})]}),h&&e.jsx("button",{className:"absolute -right-2 -top-2 transition-opacity bg-primary-light rounded-full p-1",onClick:()=>p("currentBox","Box Number",s.currentBox||s.stablePlace||""),children:e.jsx(b,{className:"w-5 h-5 text-primary"})})]}),e.jsxs("div",{className:"relative group",children:[e.jsxs(f,{type:"secondary",className:"rounded-lg !border-primary flex flex-col max-h-20 min-h-15 min-w-25","aria-label":"Weight",children:[e.jsx("span",{className:"text-primary mb-1",children:"Weight"}),e.jsxs("span",{className:"text-xs",children:[g,"kg"]})]}),h&&e.jsx("button",{className:"absolute -right-2 -top-2 transition-opacity bg-primary-light rounded-full p-1",onClick:()=>p("weight","Weight",s.weight||""),children:e.jsx(b,{className:"w-5 h-5 text-primary"})})]}),e.jsxs("div",{className:"relative group",children:[e.jsxs(f,{type:"secondary",className:"rounded-lg !border-primary flex flex-col max-h-20 min-h-15 min-w-25","aria-label":"Height",children:[e.jsx("span",{className:"text-primary mb-1",children:"Height"}),e.jsxs("span",{className:"text-xs",children:[N,"cm"]})]}),h&&e.jsx("button",{className:"absolute -right-2 -top-2 transition-opacity bg-primary-light rounded-full p-1",onClick:()=>p("height","Height",s.height||""),children:e.jsx(b,{className:"w-5 h-5 text-primary"})})]})]})]}),e.jsx("div",{className:"relative mt-4 border-2 border-primary rounded-lg overflow-hidden",children:e.jsx("div",{className:"w-full h-55 relative",children:e.jsx("img",{src:c,alt:`Image of ${a}`,className:"w-full h-full object-cover"})})})]}),e.jsxs("div",{className:"lg:hidden relative",children:[e.jsx("div",{className:"w-full sm:h-100 h-90 md:h-130",children:e.jsx("img",{src:c,alt:`Image of ${a}`,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"px-4 sm:px-6 md:px-8 py-6 bg-background rounded-t-3xl -mt-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col gap-1 relative group",children:[e.jsx("h1",{className:"text-3xl font-heading font-semibold pr-8",children:a}),e.jsx("p",{className:"text-sm text-gray",children:m}),e.jsx("p",{className:"text-sm text-gray",children:u}),e.jsxs("p",{className:"text-sm text-gray",children:["Color: ",d]})]}),e.jsxs("div",{className:"flex justify-start gap-2 mt-6 md:justify-center md:px-20",children:[e.jsxs("div",{className:"flex flex-col items-center w-full md:w-9/10 relative group",children:[e.jsx(f,{type:"secondary",className:"w-full h-15 md:h-17 !bg-primary-light !border-primary rounded-xl","aria-label":"Stable Place",children:e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("p",{className:"text-primary",children:"Box"}),e.jsx("p",{className:"mt-1 text-sm text-center",children:x})]})}),h&&e.jsx("button",{className:"absolute -right-1 -top-1 transition-opacity bg-white rounded-full p-1",onClick:()=>p("currentBox","Box Number",s.currentBox||s.stablePlace||""),children:e.jsx(b,{className:"w-5 h-5 text-primary"})})]}),e.jsxs("div",{className:"flex flex-col items-center w-full md:w-9/10 relative group",children:[e.jsx(f,{type:"secondary",className:"w-full h-15 md:h-17 !bg-primary-light !border-primary rounded-xl","aria-label":"Weight",children:e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("p",{className:"text-primary",children:"Weight"}),e.jsxs("p",{className:"mt-1 text-sm text-center",children:[g,"kg"]})]})}),h&&e.jsx("button",{className:"absolute -right-1 -top-1 transition-opacity bg-white rounded-full p-1",onClick:()=>p("weight","Weight",s.weight||""),children:e.jsx(b,{className:"w-5 h-5 text-primary"})})]}),e.jsxs("div",{className:"flex flex-col items-center w-full md:w-9/10 relative group",children:[e.jsx(f,{type:"secondary",className:"w-full h-15 md:h-17 !bg-primary-light !border-primary rounded-xl","aria-label":"Height",children:e.jsxs("div",{className:"flex flex-col items-center w-full",children:[e.jsx("p",{className:"text-primary",children:"Height"}),e.jsxs("p",{className:"mt-1 text-sm text-center",children:[" ",N,"cm"]})]})}),h&&e.jsx("button",{className:"absolute -right-1 -top-1 transition-opacity bg-white rounded-full p-1",onClick:()=>p("height","Height",s.height||""),children:e.jsx(b,{className:"w-5 h-5 text-primary"})})]})]})]})]}),e.jsx(k,{isOpen:i.isOpen,onClose:U,fieldName:i.field,fieldLabel:i.label,initialValue:i.value,userId:s?.id,multiline:i.multiline,userData:s,refreshUserData:n,isHorse:!0,isCurrentUser:h})]})},F=({activeTab:r,onChange:l})=>e.jsx("div",{className:"px-1 md:px-6 py-2 mb-4",children:e.jsxs("div",{className:"flex justify-evenly px-0 sm:px-10 md:px-20 relative",children:[e.jsxs("button",{className:`px-4 py-1 text-lg lg:text-xl lg:py-2 font-semibold relative ${r==="info"?"text-primary":"text-gray"}`,onClick:()=>l("info"),children:["About",r==="info"&&e.jsx(y.div,{layoutId:"horseUnderline",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]}),e.jsxs("button",{className:`px-4 py-1 text-lg lg:text-xl lg:py-2 font-semibold relative ${r==="owners"?"text-primary":"text-gray"}`,onClick:()=>l("owners"),children:["Riders",r==="owners"&&e.jsx(y.div,{layoutId:"horseUnderline",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]})]})}),re=()=>{const{horseId:r}=$(),[l,n]=j.useState("info"),[o,i]=j.useState(0),{horse:t,horseProfile:s,loading:a,error:c,loadingState:d,fetchHorseProfile:m}=A(r),u=j.useCallback(async()=>{if(r)try{await m(r),i(x=>x+1)}catch(x){console.error("Error refreshing horse profile:",x)}},[r,m]);return j.useEffect(()=>{r&&m(r)},[r,m]),a?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx(H,{size:"medium",className:"text-gray"}),e.jsx("span",{className:"ml-2",children:d.getMessage()})]}):c||!t?e.jsxs("div",{className:"bg-white rounded-lg p-6 m-4 text-center",children:[e.jsx("h2",{className:"text-xl font-medium mb-2",children:"Horse not found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Whoa there! This horse has left the stable 🐎"})]}):e.jsxs("div",{className:"flex flex-col min-h-screen bg-background pb-20 lg:p-0 overflow-y-auto",children:[e.jsx(z,{horse:t,horseProfile:s,forceRefresh:u},`header-${o}`),e.jsx(F,{activeTab:l,onChange:n}),e.jsx(D,{horse:t,horseProfile:s,activeTab:l,forceRefresh:u},`content-${o}`)]})};export{re as default};
