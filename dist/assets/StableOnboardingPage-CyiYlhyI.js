import{j as e,B as p,u as E,R as x,L as I}from"./index-BEvGyptE.js";import{u as O,r as T}from"./vendor-router-BURTDQSf.js";import{a as j}from"./vendor-forms-DlkW-UdB.js";import{u as F,C as f}from"./useStableOnboarding-CY4kJ_y9.js";import{J as S}from"./JoinStableForm-DEBWaGz6.js";import"./vendor-react-DavUf6mE.js";import"./FormMessage-DkOtjBWz.js";import"./HandRaisedIcon-BPyHQwh7.js";import"./LocationPinIcon-C-xH8vE4.js";const B=({onCreateStable:s,onJoinStable:a})=>e.jsxs("div",{className:"space-y-3 flex flex-col items-center",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Welcome to Equilog!"}),e.jsx("p",{className:"text-gray",children:"Let's get started by setting up your stable. You can either create a new stable or join an existing one."})]}),e.jsx(p,{type:"primary",className:"w-9/10 max-w-md",onClick:s,children:"New stable"}),e.jsx(p,{type:"secondary",className:"w-9/10 max-w-md",onClick:a,children:"Search for existing stable"})]}),c=({imageSrc:s="/images/FirstLoginImage.webp",imageAlt:a="Horse in paddock",children:m,showImage:t=!0})=>e.jsxs("div",{className:"flex flex-col items-center w-full px-4 sm:px-6 md:px-8",role:"region","aria-labelledby":"onboarding-title",children:[t&&e.jsx("div",{className:"my-2 mx-2",children:e.jsx("div",{className:"relative",children:e.jsx("img",{src:s,alt:a,className:"max-h-[50vh] sm:max-h-[55vh] md:max-h-[50vh] rounded-lg border border-primary object-cover mx-auto"})})}),e.jsx("div",{className:"w-full mt-4 sm:mt-6 mx-2 sm:mx-4",children:m})]}),J=()=>{const s=O(),{verifyToken:a}=E(),{currentStep:m,loading:t,error:n,message:l,loadingState:r,formMethods:u,navigateToStep:d,handleCreateStable:v}=F(),N=j({defaultValues:{stableName:"",streetAddress:"",postCode:"",county:"",typeOfStable:"",stableBoxes:""},mode:"onChange"}),w=j({defaultValues:{stableName:"",streetAddress:"",postCode:"",county:"",typeOfStable:"",stableBoxes:""},mode:"onChange"}),h=async o=>{const i=await v(o);i.success&&i.stable&&(await a(),sessionStorage.removeItem("isFirstLogin"),s(x.SELECT_STABLE))},b=T.useCallback(async o=>{if(o.action==="request"&&o.requestSent)try{sessionStorage.removeItem("isFirstLogin"),s(x.SELECT_STABLE,{state:{message:"Your request to join the stable has been sent. Please wait for approval.",type:"success",source:"/stable-onboarding"}})}catch(i){console.error("Error handling join request:",i)}},[s]),y=()=>d("create"),C=()=>d("join"),g=()=>d("welcome"),L=()=>s(x.LOGIN),k=()=>{if(t)return e.jsx(c,{title:"Setting up your account",showImage:!1,children:e.jsxs("div",{className:"flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(I,{size:"medium"})}),e.jsx("p",{className:"text-center text-gray",children:r.getMessage()||"Setting up your new account..."})]})});switch(m){case"welcome":return e.jsx(c,{title:"EQUILOG",showImage:!0,children:e.jsx(B,{onCreateStable:y,onJoinStable:C})});case"create":return e.jsx(c,{title:"Create new Stable",showImage:!1,children:e.jsx(f,{formMethods:u,onSubmit:h,onCancel:g,isLoading:t,loadingState:r,error:n,message:l})});case"join":return e.jsx(c,{title:"Join Stable",showImage:!1,children:e.jsx(S,{formMethods:u,onSubmit:b,onCancel:g,isLoading:t,loadingState:r,error:n,message:l})});default:return e.jsx("div",{children:"Unknown step"})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:hidden w-full py-2",role:"main","aria-live":"polite",children:k()}),e.jsxs("div",{className:"hidden lg:flex h-screen overflow-hidden",children:[e.jsx("div",{className:"w-1/2 bg-background p-8 overflow-y-auto flex flex-col items-center",children:e.jsxs("div",{className:"max-w-md w-full mt-16",children:[e.jsx("h2",{className:"text-3xl mb-10 text-center",children:"Join a stable"}),e.jsx("div",{className:"mb-10",children:e.jsx(S,{formMethods:N,onSubmit:b,onCancel:null,isLoading:t,loadingState:r,error:n,message:l,hideLabel:!0,inputClassName:"!bg-white",desktopView:!0})}),e.jsxs("div",{className:"flex items-center my-8",children:[e.jsx("div",{className:"flex-1 border-t border-gray"}),e.jsx("span",{className:"px-4 text-gray",children:"Or"}),e.jsx("div",{className:"flex-1 border-t border-gray"})]}),e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4",children:[e.jsx("span",{className:"text-sm text-gray",children:"Go back to"}),e.jsx("button",{type:"button",className:"text-sm font-semibold text-primary hover:underline focus:outline-none",onClick:L,children:"Sign in"})]})]})}),e.jsx("div",{className:"w-1/2 bg-white p-1 overflow-y-auto flex flex-col items-center",children:e.jsxs("div",{className:"max-w-md w-full mt-16",children:[e.jsx("h2",{className:"text-3xl mb-8 text-center",children:"Create a stable"}),e.jsx("div",{className:"max-h-8/12",children:e.jsx(f,{formMethods:w,onSubmit:h,onCancel:null,isLoading:t,loadingState:r,error:n,message:l,desktopView:!0,hideLabel:!0,inputClassName:""})})]})})]})]})},Y=()=>e.jsx("div",{className:"h-full w-full",children:e.jsx(J,{})});export{Y as default};
